!function(){var n=window.nLingual={},a=n.Framework={},e=a.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),t=a.LanguageSet=Backbone.Collection.extend({model:e}),l=a.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),i=a.LocalizableFieldSet=Backbone.Collection.extend({model:l}),o=n.Languages=new t,r=n.LocalizableFields=new i;jQuery(function(a){var t,l,i,d;if(a(".nl-checkall").change(function(){var n=a(this).data("name");a('input[name="'+n+'[]"]').attr("checked",this.checked)}),a(".nl-matchall").change(function(){var n=a(this).data("name");a('[name="'+n+'"]').val(this.checked?"*":"")}),a(".nl-section-content").hide(),a(".nl-section-toggle").each(function(){a(this).data("text",a(this).text())}).click(function(){var n,e,t;(e=(n=a(this)).parent()).toggleClass("open"),t=e.hasClass("open"),e.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(t?"alt":"text"))}),a(".nl-preview").on("nl:render",function(){var n,e,t,l,i,r;n=a("#nlingual_default_language").val(),(n=o.get(n))&&(e=n.get("slug")||"en"),t=a("#nlingual_query_var").val()||"nl_language",l=a("#nlingual_skip_default_l10n").attr("checked"),i=a("#nlingual_post_language_override").attr("checked"),r=a(this).hasClass("nl-url-preview")?a(this).data(l?"excluded":"included"):a(this).hasClass("nl-override-preview")?a(this).data(i?"on":"off"):a(this).data("format"),a(this).text(r.replace(/%l/g,e).replace(/%v/g,t))}).trigger("nl:render"),a("#nlingual_default_language").change(function(){a(".nl-preview").trigger("nl:render")}),a("#nlingual_skip_default_l10n").change(function(){a(".nl-preview").trigger("nl:render")}),a("#nlingual_post_language_override").change(function(){a(".nl-preview").trigger("nl:render")}),a("#nlingual_query_var").on("keyup change",function(){a(".nl-preview").trigger("nl:render")}),a(".nl-preview").hide().filter(".nl-redirect-get").show(),a('input[name="nlingual_options[url_rewrite_method]"]').change(function(){var n=a(this).val();this.checked&&n&&a(".nl-preview").hide().filter(".nl-redirect-"+n).show()}).change(),a("#nlingual_languages").each(function(){function t(n){var e,t,l,i;for(i in e=(e=s).replace(/%id%/g,n.id),n.attributes)l=new RegExp("%"+i+"%","g"),e=e.replace(l,n.get(i));(t=a(e)).find('.nl-language-direction input[value="'+n.get("direction")+'"]').attr("checked",!0),t.find(".nl-language-active input").attr("checked",n.get("active")),r.append(t).sortable("refresh")}var l,i,r,d,s,c,g;for(g in l=a(this),i=a("#nl_language_preset"),r=a("#nl_language_list"),d=a("#nl_language_add"),s=a("#nl_language_row").text(),c=-1,r.sortable({items:"tr",containment:"parent",handle:".handle"}),n.presets)i.append('<option value="'+g+'">'+n.presets[g].system_name+"</option>");o.each(t),d.click(function(){var a,l;i.val()?(l=i.val(),(a=new e(n.presets[l])).set("iso_code",l),i.val(null)):a=new e,a.id=c,a.set("slug",a.get("iso_code")),a.set("active",!0),t(a),c--}),l.on("change",".nl-language-delete input",function(){var n=a(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)}),l.on("change",".nl-language-system_name input",function(){var n,e,t,l,i;n=a(this).parents("tr").first(),e=a(this).val(),t=n.find(".nl-language-locale_name input"),l=n.find(".nl-language-iso_code input"),i=n.find(".nl-language-slug input"),l.val()||l.val(e.substr(0,2).toLowerCase()),t.val()||t.val(l.val()),i.val()||i.val(l.val())})}),t=a('<div class="nl-localizer"></div>').html(function(){var n='<div class="nl-localizer-toggle" title="'+nlingualL10n.LocalizeThis+'"></div>';return o.each(function(a){n+='<div class="nl-localizer-option" title="'+nlingualL10n.LocalizeFor.replace("%s",a.get("system_name"))+'" data-nl_language="'+a.id+'"><div class="nl-option-text" data-slug="'+a.get("slug")+'">'+a.get("system_name")+"</div></div>"}),n}),l="nlLocalizerSkipUpdate",r.each(function(e){var l,i,r,d,s,c,g,u;l=e.get("field_id"),i=e.get("values"),r=e.get("nonce"),d=!1,0!==(s=a("#"+l)).length&&s.is("input, textarea")&&(s.addClass("nl-localizable-input"),s.hasClass("wp-editor-area")?c=s.parents(".wp-editor-wrap"):(s.wrap('<div class="nl-localizable"></div>'),c=s.parent()),g=t.clone(),s.data("$nl_localizer",g),g.data("nl_current_language",n.default_language),g.data("$nl_localizer_field",s),(u=a('<input type="hidden" />')).attr("name",s.attr("name")),u.val(s.val()),u.appendTo(c),g.data("$nl_localized_"+n.default_language,u),o.each(function(e){var t,l;n.default_language!==e.id&&(t=i[e.id]||null,(l=a('<input type="hidden" />')).attr("name","nlingual_localized["+s.attr("name")+"]["+e.id+"]"),l.val(t),g.data("$nl_localized_"+e.id,l),l.appendTo(c),""!==t&&null!==t&&(d=!0))}),d&&g.find('[data-nl_language="'+n.default_language+'"]').addClass("nl-current"),c.append('<input type="hidden" name="_nl_l10n_nonce['+e.id+']" value="'+r+'" />'),g.appendTo(c))}),a("body").on("click",".nl-localizer-option",function(){var e,t,l,i,o,r,d;t=(e=a(this)).parent(),o=e.data("nl_language"),a(this).addClass("nl-current").siblings().removeClass("nl-current"),o||(o=n.default_language),l=t.data("$nl_localizer_field"),i=t.data("$nl_localized_"+o),l.trigger("nl:localizer:update"),t.data("nl_current_language",o),r=i.val(),d=i.attr("name"),l.val(r).attr("name",d),l.trigger("nl:localizer:change")}),a("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",function(){var n,e,t;t=(n=a(this).data("$nl_localizer")).data("nl_current_language"),(e=n.data("$nl_localized_"+t)).val(this.value)}),"object"==typeof tinymce){tinymce.on("SetupEditor",function(n){var e=n.editor||n,t=a(e.getElement()),l=t.data("$nl_localizer");l&&(e.on("init",function(){a(e.getContainer()).parent().after(l)}),t.on("nl:localizer:update",function(){var n=e.getContent();n=wp.editor.removep(n),t.val(n)}),t.on("nl:localizer:change",function(){var n=t.val();n=wp.editor.autop(n),e.setContent(n)}))});var s=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){s.apply(this,arguments),this.fire("SavedContent"),a(this.getElement()).trigger("nl:localizer:save")}}a(".nl-language-input").change(function(){var n,e;n=a(this).val(),(e=a(this).parents(".nl-translation-manager")).find(".nl-manage-translations").toggleClass("hidden","0"===n),e.find(".nl-translation-field").show(),e.find(".nl-translation-"+n).hide()}).change(),a(".nl-add-translation").click(function(){var n,e,t,l,i,o,r;n=a(this).parents(".nl-field"),e=n.find(".nl-translation-input"),t=n.find(".nl-translation-select"),l=a("#post_ID").val(),i=a("#nl_language").val(),o=e.parents(".nl-field").data("nl_language"),window.open("/wp-admin/admin-post.php?"+a.param({action:"nl_new_translation",post_id:l,post_language_id:i,translation_language_id:o}),"_blank").onload=function(){var a,l=this.location.href.match(/post=(\d+)/)[1];e.val(l),n.addClass("nl-has-translation"),t.attr("name",null)}}),a(".nl-find-translation").click(function(){var n,e,t;e=(n=a(this).parents(".nl-field")).find(".nl-translation-input"),(t=n.find(".nl-translation-select")).attr("name",e.attr("name")),t.show()}),a(".nl-edit-translation").click(function(){var n,e,t;"new"===(e=(n=a(this).parents(".nl-field")).find(".nl-input").val())||parseInt(e)<=0?alert(nlingualL10n.NoPostSelected):(t=a(this).data("url").replace("%d",e),window.open(t))}),a(".nl-drop-translation").click(function(){var n,e,t,l,i;confirm(nlingualL10n.RemoveTranslationConfirm)&&(n=a(this).parents(".nl-field"),e=n.find(".nl-translation-input"),t=n.find(".nl-translation-title"),l=a("#post_ID").val(),i=e.parents(".nl-field").data("nl_language"),a.ajax({url:ajaxurl,type:"POST",data:{action:"nl_drop_translation",post_id:l,language_id:i},success:function(){e.val(null),t.text(nlingualL10n.NoTranslation),n.removeClass("nl-has-translation")},error:function(){alert(nlingualL10n.RemoveTranslationError)}}))}),"object"==typeof inlineEditPost&&(i=inlineEditPost.edit,inlineEditPost.edit=function(n){var e,t,l,o,r;i.apply(this,arguments),e=0,"object"==typeof n&&(e=parseInt(this.getId(n))),t=a("#post-"+e),l=a("#edit-"+e),o=t.find(".nl-nonce").val(),l.find(".nl-nonce").val(o),r=t.find(".nl-language").val(),l.find(".nl-language-input").val(r).change(),l.find(".nl-translation-field").each(function(){var n,e;n=a(this).data("nl_language"),e=t.find(".nl-translation-"+n).val(),a(this).find("select").val(e||0)})}),"object"==typeof inlineEditTax&&(d=inlineEditTax.edit,inlineEditTax.edit=function(){d.apply(this,arguments)})})}();
//# sourceMappingURL=admin.min.js.map