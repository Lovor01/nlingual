"use strict";function _slicedToArray(n,e){return _arrayWithHoles(n)||_iterableToArrayLimit(n,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(n,e){var a=[],t=!0,l=!1,i=void 0;try{for(var o=n[Symbol.iterator](),r;!(t=(r=o.next()).done)&&(a.push(r.value),!e||a.length!==e);t=!0);}catch(n){l=!0,i=n}finally{try{t||null==o.return||o.return()}finally{if(l)throw i}}return a}function _arrayWithHoles(n){if(Array.isArray(n))return n}function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function n(e){return typeof e}:function n(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(n)}!function(){var n=window.nLingual={},e=n.Framework={},a=e.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),t=e.LanguageSet=Backbone.Collection.extend({model:a}),l=e.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),i=e.LocalizableFieldSet=Backbone.Collection.extend({model:l}),o=n.Languages=new t,r=n.LocalizableFields=new i;jQuery(function(e){e(".nl-checkall").change(function(){var n=e(this).data("name");e('input[name="'.concat(n,'[]"]')).attr("checked",this.checked)}),e(".nl-matchall").change(function(){var n=e(this).data("name");e('[name="'.concat(n,'"]')).val(this.checked?"*":"")}),e(".nl-section-content").hide(),e(".nl-section-toggle").each(function(){e(this).data("text",e(this).text())}).click(function(){var n=e(this),a=n.parent();a.toggleClass("open");var t=a.hasClass("open");a.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(t?"alt":"text"))}),e(".nl-preview").on("nl:render",function(){var n=o.get(e("#nlingual_default_language").val()),a=n&&n.get("slug")||"en",t=e("#nlingual_query_var").val()||"nl_language",l=e("#nlingual_skip_default_l10n").attr("checked"),i=e("#nlingual_post_language_override").attr("checked"),r;e(this).hasClass("nl-url-preview")?e(this).data(l?"excluded":"included"):e(this).hasClass("nl-override-preview")?e(this).data(i?"on":"off"):e(this).data("format"),e(this).text((void 0).replace(/%l/g,a).replace(/%v/g,t))}).trigger("nl:render"),e("#nlingual_default_language").change(function(){e(".nl-preview").trigger("nl:render")}),e("#nlingual_skip_default_l10n").change(function(){e(".nl-preview").trigger("nl:render")}),e("#nlingual_post_language_override").change(function(){e(".nl-preview").trigger("nl:render")}),e("#nlingual_query_var").on("keyup change",function(){e(".nl-preview").trigger("nl:render")}),e(".nl-preview").hide().filter(".nl-redirect-get").show(),e('input[name="nlingual_options[url_rewrite_method]"]').change(function(){var n=e(this).val();this.checked&&n&&e(".nl-preview").hide().filter(".nl-redirect-".concat(n)).show()}).change(),e("#nlingual_languages").each(function(){var t=e(this),l=e("#nl_language_preset"),i=e("#nl_language_list"),r=e("#nl_language_add"),c=e("#nl_language_row").text(),d=-1;for(var s in i.sortable({items:"tr",containment:"parent",handle:".handle"}),n.presets)l.append('<option value="'.concat(s,'">').concat(n.presets[s].system_name,"</option>"));function u(n){var a=c.replace(/%id%/g,n.id);for(var t in n.attributes){var l=new RegExp("%"+t+"%","g");a=a.replace(l,n.get(t))}var o=e(a);o.find('.nl-language-direction input[value="'.concat(n.get("direction"),'"]')).attr("checked",!0),o.find(".nl-language-active input").attr("checked",n.get("active")),i.append(o).sortable("refresh")}o.each(u),r.click(function(){var e;if(l.val()){var t=l.val();(e=new a(n.presets[t])).set("iso_code",t),l.val(null)}else e=new a;e.id=d,e.set("slug",e.get("iso_code")),e.set("active",!0),u(e),d--}),t.on("change",".nl-language-delete input",function(){var n=e(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)}),t.on("change",".nl-language-system_name input",function(){var n=e(this).parents("tr").first(),a=e(this).val(),t=n.find(".nl-language-locale_name input"),l=n.find(".nl-language-iso_code input"),i=n.find(".nl-language-slug input");l.val()||l.val(a.substr(0,2).toLowerCase()),t.val()||t.val(l.val()),i.val()||i.val(l.val())})});var t=e('<div class="nl-localizer"></div>').html(function(){var n='<div class="nl-localizer-toggle" title="'.concat(nlingualL10n.LocalizeThis,'"></div>');return o.each(function(e){var a=nlingualL10n.LocalizeFor.replace("%s",e.get("system_name"));n+='<div class="nl-localizer-option" title="'.concat(a,'" data-nl_language="').concat(e.id,'">\n\t\t\t\t\t<div class="nl-option-text" data-slug="').concat(e.get("slug"),'">').concat(e.get("system_name"),"</div>\n\t\t\t\t</div>")}),n});if(r.each(function(a){var l=a.get("field_id"),i=a.get("values"),r=a.get("nonce"),c=!1,d=e("#"+l);if(0!==d.length&&d.is("input, textarea")){var s;d.addClass("nl-localizable-input"),d.hasClass("wp-editor-area")?s=d.parents(".wp-editor-wrap"):(d.wrap('<div class="nl-localizable"></div>'),s=d.parent());var u=t.clone();d.data("$nl_localizer",u),u.data("nl_current_language",n.default_language),u.data("$nl_localizer_field",d);var g=e('<input type="hidden" />'),c;g.attr("name",d.attr("name")),g.val(d.val()),g.appendTo(s),u.data("$nl_localized_".concat(n.default_language),g),o.each(function(a){if(n.default_language!==a.id){var t=i[a.id]||null,l=e('<input type="hidden" />');l.attr("name","nlingual_localized[".concat(d.attr("name"),"][").concat(a.id,"]")),l.val(t),u.data("$nl_localized_".concat(a.id),l),l.appendTo(s),""!==t&&null!==t&&(c=!0)}}),c&&u.find('[data-nl_language="'.concat(n.default_language,'"]')).addClass("nl-current"),s.append('<input type="hidden" name="_nl_l10n_nonce['.concat(a.id,']" value="').concat(r,'" />')),u.appendTo(s)}}),e("body").on("click",".nl-localizer-option",function(){var a=e(this),t=a.parent(),l=a.data("nl_language")||n.default_language;e(this).addClass("nl-current").siblings().removeClass("nl-current");var i=t.data("$nl_localizer_field"),o=t.data("$nl_localized_".concat(l));i.trigger("nl:localizer:update"),t.data("nl_current_language",l);var r=o.val(),c=o.attr("name");i.val(r).attr("name",c),i.trigger("nl:localizer:change")}),e("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",function(){var n=e(this).data("$nl_localizer"),a=n.data("nl_current_language"),t;n.data("$nl_localized_".concat(a)).val(this.value)}),"object"===("undefined"==typeof tinymce?"undefined":_typeof(tinymce))){tinymce.on("SetupEditor",function(n){var a=n.editor||n,t=e(a.getElement()),l=t.data("$nl_localizer");l&&(a.on("init",function(){e(a.getContainer()).parent().after(l)}),t.on("nl:localizer:update",function(){var n=wp.editor.removep(a.getContent());t.val(n)}),t.on("nl:localizer:change",function(){var n=wp.editor.autop(t.val());a.setContent(n)}))});var l=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){l.apply(this,arguments),this.fire("SavedContent"),e(this.getElement()).trigger("nl:localizer:save")}}if(e(".nl-language-input").change(function(){var n=e(this).val(),a=e(this).parents(".nl-translation-manager");a.find(".nl-manage-translations").toggleClass("hidden","0"===n),a.find(".nl-translation-field").show(),a.find(".nl-translation-"+n).hide()}).change(),e(".nl-translation-field").each(function(){var n=e(this).find(".nl-input").val(),a=e(this).find(".nl-add-translation"),t=e(this).find(".nl-edit-translation");t.hide(),parseInt(n,10)&&(a.hide(),t.show())}),e(".nl-add-translation").click(function(){var n=e(this).parents(".nl-field"),a=n.find(".nl-input"),t=n.find(".nl-add-translation"),l=n.find(".nl-edit-translation"),i=e("#post_ID").val(),o=e("#nl_language").val(),r=a.parents(".nl-field").data("nl_language"),c;window.open("/wp-admin/admin-post.php?"+e.param({action:"nl_new_translation",post_id:i,post_language_id:o,translation_language_id:r}),"_blank").onload=function(){var n,e,i=_slicedToArray(this.location.href.match(/post=(\d+)/),2)[1];a.val(i),t.hide(),l.show().attr("title")}}),e(".nl-edit-translation").click(function(){var n,a=e(this).parents(".nl-field").find(".nl-input").val();if("new"===a||parseInt(a,10)<=0)alert(nlingualL10n.NoPostSelected);else{var t=e(this).data("url").replace("%d",a);window.open(t)}}),"object"===("undefined"==typeof inlineEditPost?"undefined":_typeof(inlineEditPost))){var i=inlineEditPost.edit;inlineEditPost.edit=function(n){i.apply(this,arguments);var a=n&&parseInt(this.getId(n),10)||0,t=e("#post-".concat(a)),l=e("#edit-".concat(a)),o=t.find(".nl-nonce").val();l.find(".nl-nonce").val(o);var r=t.find(".nl-language").val();l.find(".nl-language-input").val(r).change(),l.find(".nl-translation-field").each(function(){var n=e(this).data("nl_language"),a=t.find(".nl-translation-".concat(n)).val();e(this).find("select").val(a||0)})}}if("object"===("undefined"==typeof inlineEditTax?"undefined":_typeof(inlineEditTax))){var c=inlineEditTax.edit;inlineEditTax.edit=function(){c.apply(this,arguments)}}})}();
//# sourceMappingURL=admin.min.js.map