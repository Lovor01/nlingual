!function(){var g=window.nLingual={},n=g.Framework={},r=n.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),e=n.LanguageSet=Backbone.Collection.extend({model:r}),a=n.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),t=n.LocalizableFieldSet=Backbone.Collection.extend({model:a}),u=g.Languages=new e,l=g.LocalizableFields=new t;jQuery(function(s){var c,n,d,e;if(s(".nl-checkall").change(function(){var n=s(this).data("name");s('input[name="'+n+'[]"]').attr("checked",this.checked)}),s(".nl-matchall").change(function(){var n=s(this).data("name");s('[name="'+n+'"]').val(this.checked?"*":"")}),s(".nl-section-content").hide(),s(".nl-section-toggle").each(function(){s(this).data("text",s(this).text())}).click(function(){var n,e,a;(e=(n=s(this)).parent()).toggleClass("open"),a=e.hasClass("open"),e.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(a?"alt":"text"))}),s(".nl-preview").on("nl:render",function(){var n,e,a,t,l,i;n=s("#nlingual_default_language").val(),(n=u.get(n))&&(e=n.get("slug")||"en"),a=s("#nlingual_query_var").val()||"nl_language",t=s("#nlingual_skip_default_l10n").attr("checked"),l=s("#nlingual_post_language_override").attr("checked"),i=s(this).hasClass("nl-url-preview")?s(this).data(t?"excluded":"included"):s(this).hasClass("nl-override-preview")?s(this).data(l?"on":"off"):s(this).data("format"),s(this).text(i.replace(/%l/g,e).replace(/%v/g,a))}).trigger("nl:render"),s("#nlingual_default_language").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_skip_default_l10n").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_post_language_override").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_query_var").on("keyup change",function(){s(".nl-preview").trigger("nl:render")}),s(".nl-preview").hide().filter(".nl-redirect-get").show(),s('input[name="nlingual_options[url_rewrite_method]"]').change(function(){var n=s(this).val();this.checked&&n&&s(".nl-preview").hide().filter(".nl-redirect-"+n).show()}).change(),s("#nlingual_languages").each(function(){var n,a,i,e,d,t,l;for(l in n=s(this),a=s("#nl_language_preset"),i=s("#nl_language_list"),e=s("#nl_language_add"),d=s("#nl_language_row").text(),t=-1,i.sortable({items:"tr",containment:"parent",handle:".handle"}),g.presets)a.append('<option value="'+l+'">'+g.presets[l].system_name+"</option>");function o(n){var e,a,t,l;for(l in e=(e=d).replace(/%id%/g,n.id),n.attributes)t=new RegExp("%"+l+"%","g"),e=e.replace(t,n.get(l));(a=s(e)).find('.nl-language-direction input[value="'+n.get("direction")+'"]').attr("checked",!0),a.find(".nl-language-active input").attr("checked",n.get("active")),i.append(a).sortable("refresh")}u.each(o),e.click(function(){var n,e;a.val()?(e=a.val(),(n=new r(g.presets[e])).set("iso_code",e),a.val(null)):n=new r,n.id=t,n.set("slug",n.get("iso_code")),n.set("active",!0),o(n),t--}),n.on("change",".nl-language-delete input",function(){var n=s(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)}),n.on("change",".nl-language-system_name input",function(){var n,e,a,t,l;n=s(this).parents("tr").first(),e=s(this).val(),a=n.find(".nl-language-locale_name input"),t=n.find(".nl-language-iso_code input"),l=n.find(".nl-language-slug input"),t.val()||t.val(e.substr(0,2).toLowerCase()),a.val()||a.val(t.val()),l.val()||l.val(t.val())})}),c=s('<div class="nl-localizer"></div>').html(function(){var e='<div class="nl-localizer-toggle" title="'+nlingualL10n.LocalizeThis+'"></div>';return u.each(function(n){e+='<div class="nl-localizer-option" title="'+nlingualL10n.LocalizeFor.replace("%s",n.get("system_name"))+'" data-nl_language="'+n.id+'"><div class="nl-option-text" data-slug="'+n.get("slug")+'">'+n.get("system_name")+"</div></div>"}),e}),n="nlLocalizerSkipUpdate",l.each(function(n){var e,t,a,l,i,d,o,r;e=n.get("field_id"),t=n.get("values"),a=n.get("nonce"),l=!1,0!==(i=s("#"+e)).length&&i.is("input, textarea")&&(i.addClass("nl-localizable-input"),d=i.hasClass("wp-editor-area")?i.parents(".wp-editor-wrap"):(i.wrap('<div class="nl-localizable"></div>'),i.parent()),o=c.clone(),i.data("$nl_localizer",o),o.data("nl_current_language",g.default_language),o.data("$nl_localizer_field",i),(r=s('<input type="hidden" />')).attr("name",i.attr("name")),r.val(i.val()),r.appendTo(d),o.data("$nl_localized_"+g.default_language,r),u.each(function(n){var e,a;g.default_language!==n.id&&(e=t[n.id]||null,(a=s('<input type="hidden" />')).attr("name","nlingual_localized["+i.attr("name")+"]["+n.id+"]"),a.val(e),o.data("$nl_localized_"+n.id,a),a.appendTo(d),""!==e&&null!==e&&(l=!0))}),l&&o.find('[data-nl_language="'+g.default_language+'"]').addClass("nl-current"),d.append('<input type="hidden" name="_nl_l10n_nonce['+n.id+']" value="'+a+'" />'),o.appendTo(d))}),s("body").on("click",".nl-localizer-option",function(){var n,e,a,t,l,i,d;e=(n=s(this)).parent(),l=n.data("nl_language"),s(this).addClass("nl-current").siblings().removeClass("nl-current"),l||(l=g.default_language),a=e.data("$nl_localizer_field"),t=e.data("$nl_localized_"+l),a.trigger("nl:localizer:update"),e.data("nl_current_language",l),i=t.val(),d=t.attr("name"),a.val(i).attr("name",d),a.trigger("nl:localizer:change")}),s("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",function(){var n,e,a;a=(n=s(this).data("$nl_localizer")).data("nl_current_language"),(e=n.data("$nl_localized_"+a)).val(this.value)}),"object"==typeof tinymce){tinymce.on("SetupEditor",function(n){var e=n.editor||n,a=s(e.getElement()),t=a.data("$nl_localizer");t&&(e.on("init",function(){s(e.getContainer()).parent().after(t)}),a.on("nl:localizer:update",function(){var n=e.getContent();n=wp.editor.removep(n),a.val(n)}),a.on("nl:localizer:change",function(){var n=a.val();n=wp.editor.autop(n),e.setContent(n)}))});var a=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){a.apply(this,arguments),this.fire("SavedContent"),s(this.getElement()).trigger("nl:localizer:save")}}s(".nl-language-input").change(function(){var n,e;n=s(this).val(),(e=s(this).parents(".nl-translation-manager")).find(".nl-manage-translations").toggleClass("hidden","0"===n),e.find(".nl-translation-field").show(),e.find(".nl-translation-"+n).hide()}).change(),s(".nl-translation-field").each(function(){var n=s(this).find(".nl-input").val(),e=s(this).find(".nl-add-translation"),a=s(this).find(".nl-edit-translation");a.hide(),parseInt(n)&&(e.hide(),a.show())}),s(".nl-add-translation").click(function(){var n,a,t,l,e,i,d,o;n=s(this).parents(".nl-field"),a=n.find(".nl-input"),t=n.find(".nl-add-translation"),l=n.find(".nl-edit-translation"),e=s("#post_ID").val(),i=s("#nl_language").val(),d=a.parents(".nl-field").data("nl_language"),window.open("/wp-admin/admin-post.php?"+s.param({action:"nl_new_translation",post_id:e,post_language_id:i,translation_language_id:d}),"_blank").onload=function(){var n,e=this.location.href.match(/post=(\d+)/)[1];a.val(e),t.hide(),l.show().attr("title")}}),s(".nl-edit-translation").click(function(){var n,e,a;"new"===(e=(n=s(this).parents(".nl-field")).find(".nl-input").val())||parseInt(e)<=0?alert(nlingualL10n.NoPostSelected):(a=s(this).data("url").replace("%d",e),window.open(a))}),"object"==typeof inlineEditPost&&(d=inlineEditPost.edit,inlineEditPost.edit=function(n){var e,a,t,l,i;d.apply(this,arguments),e=0,"object"==typeof n&&(e=parseInt(this.getId(n))),a=s("#post-"+e),t=s("#edit-"+e),l=a.find(".nl-nonce").val(),t.find(".nl-nonce").val(l),i=a.find(".nl-language").val(),t.find(".nl-language-input").val(i).change(),t.find(".nl-translation-field").each(function(){var n,e;n=s(this).data("nl_language"),e=a.find(".nl-translation-"+n).val(),s(this).find("select").val(e||0)})}),"object"==typeof inlineEditTax&&(e=inlineEditTax.edit,inlineEditTax.edit=function(){e.apply(this,arguments)})})}();
//# sourceMappingURL=admin.min.js.map