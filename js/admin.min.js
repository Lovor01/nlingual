!function(){"use strict";function n(a){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(a)}function a(n,a){return function(n){if(Array.isArray(n))return n}(n)||function(n,a){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(n)))return;var e=[],t=!0,l=!1,i=void 0;try{for(var r,o=n[Symbol.iterator]();!(t=(r=o.next()).done)&&(e.push(r.value),!a||e.length!==a);t=!0);}catch(n){l=!0,i=n}finally{try{t||null==o.return||o.return()}finally{if(l)throw i}}return e}(n,a)||function(n,a){if(!n)return;if("string"==typeof n)return e(n,a);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(n);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return e(n,a)}(n,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(n,a){(null==a||a>n.length)&&(a=n.length);for(var e=0,t=new Array(a);e<a;e++)t[e]=n[e];return t}var t,l,i,r,o,c,d,s;t=window.nLingual={},l=t.Framework={},i=l.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),r=l.LanguageSet=Backbone.Collection.extend({model:i}),o=l.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),c=l.LocalizableFieldSet=Backbone.Collection.extend({model:o}),d=t.Languages=new r,s=t.LocalizableFields=new c,jQuery((function(e){e(".nl-checkall").change((function(){var n=e(this).data("name");e('input[name="'.concat(n,'[]"]')).attr("checked",this.checked)})),e(".nl-matchall").change((function(){var n=e(this).data("name");e('[name="'.concat(n,'"]')).val(this.checked?"*":"")})),e(".nl-section-content").hide(),e(".nl-section-toggle").each((function(){e(this).data("text",e(this).text())})).click((function(){var n=e(this),a=n.parent();a.toggleClass("open");var t=a.hasClass("open");a.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(t?"alt":"text"))})),e(".nl-preview").on("nl:render",(function(){var n,a=d.get(e("#nlingual_default_language").val()),t=a&&a.get("slug")||"en",l=e("#nlingual_query_var").val()||"nl_language",i=e("#nlingual_skip_default_l10n").is(":checked"),r=e("#nlingual_post_language_override").is(":checked");n=e(this).hasClass("nl-url-preview")?e(this).data(i?"excluded":"included"):e(this).hasClass("nl-override-preview")?e(this).data(r?"on":"off"):e(this).data("format"),e(this).text(n.replace(/%l/g,t).replace(/%v/g,l))})).trigger("nl:render"),e("#nlingual_default_language").change((function(){e(".nl-preview").trigger("nl:render")})),e("#nlingual_skip_default_l10n").change((function(){e(".nl-preview").trigger("nl:render")})),e("#nlingual_post_language_override").change((function(){e(".nl-preview").trigger("nl:render")})),e("#nlingual_query_var").on("keyup change",(function(){e(".nl-preview").trigger("nl:render")})),e(".nl-preview").hide().filter(".nl-redirect-get").show(),e('input[name="nlingual_options[url_rewrite_method]"]').change((function(){var n=e(this).val();this.checked&&n&&e(".nl-preview").hide().filter(".nl-redirect-".concat(n)).show()})).change(),e("#nlingual_languages").each((function(){var n=e(this),a=e("#nl_language_preset"),l=e("#nl_language_list"),r=e("#nl_language_add"),o=e("#nl_language_row").text(),c=-1;for(var s in l.sortable({items:"tr",containment:"parent",handle:".handle"}),t.presets)a.append('<option value="'.concat(s,'">').concat(t.presets[s].system_name,"</option>"));function u(n){var a=o.replace(/%id%/g,n.id);for(var t in n.attributes){var i=new RegExp("%"+t+"%","g");a=a.replace(i,n.get(t))}var r=e(a);r.find('.nl-language-direction input[value="'.concat(n.get("direction"),'"]')).attr("checked",!0),r.find(".nl-language-active input").attr("checked",n.get("active")),l.append(r).sortable("refresh")}d.each(u),r.click((function(){var n;if(a.val()){var e=a.val();(n=new i(t.presets[e])).set("iso_code",e),a.val(null)}else n=new i;n.id=c,n.set("slug",n.get("iso_code")),n.set("active",!0),u(n),c--})),n.on("change",".nl-language-delete input",(function(){var n=e(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)})),n.on("change",".nl-language-system_name input",(function(){var n=e(this).parents("tr").first(),a=e(this).val(),t=n.find(".nl-language-locale_name input"),l=n.find(".nl-language-iso_code input"),i=n.find(".nl-language-slug input");l.val()||l.val(a.substr(0,2).toLowerCase()),t.val()||t.val(l.val()),i.val()||i.val(l.val())}))}));var l=e('<div class="nl-localizer"></div>').html((function(){var n='<div class="nl-localizer-toggle" title="'.concat(nlingualL10n.LocalizeThis,'"></div>');return d.each((function(a){var e=nlingualL10n.LocalizeFor.replace("%s",a.get("system_name"));n+='<div class="nl-localizer-option" title="'.concat(e,'" data-nl_language="').concat(a.id,'">\n\t\t\t\t\t<div class="nl-option-text" data-slug="').concat(a.get("slug"),'">').concat(a.get("system_name"),"</div>\n\t\t\t\t</div>")})),n}));s.each((function(n){var a=n.get("field_id"),i=e("#"+a);if(0!==i.length&&i.is("input, textarea")){var r,o=n.get("values"),c=n.get("nonce");i.addClass("nl-localizable-input"),i.hasClass("wp-editor-area")?r=i.parents(".wp-editor-wrap"):(i.wrap('<div class="nl-localizable"></div>'),r=i.parent());var s=l.clone();i.data("$nl_localizer",s),s.data("nl_current_language",t.default_language),s.data("$nl_localizer_field",i);var u=e('<input type="hidden" />');u.attr("name",i.attr("name")),u.val(i.val()),u.appendTo(r),s.data("$nl_localized_".concat(t.default_language),u);var g=!1;d.each((function(n){if(t.default_language!==n.id){var a=o[n.id]||null,l=e('<input type="hidden" />');l.attr("name","nlingual_localized[".concat(i.attr("name"),"][").concat(n.id,"]")),l.val(a),s.data("$nl_localized_".concat(n.id),l),l.appendTo(r),""!==a&&null!==a&&(g=!0)}})),g&&s.find('[data-nl_language="'.concat(t.default_language,'"]')).addClass("nl-current"),r.append('<input type="hidden" name="_nl_l10n_nonce['.concat(n.id,']" value="').concat(c,'" />')),s.appendTo(r)}})),e("body").on("click",".nl-localizer-option",(function(){var n=e(this),a=n.parent(),l=n.data("nl_language")||t.default_language;e(this).addClass("nl-current").siblings().removeClass("nl-current");var i=a.data("$nl_localizer_field"),r=a.data("$nl_localized_".concat(l));i.trigger("nl:localizer:update"),a.data("nl_current_language",l);var o=r.val(),c=r.attr("name");i.val(o).attr("name",c),i.trigger("nl:localizer:change")})),e("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",(function(){var n=e(this).data("$nl_localizer"),a=n.data("nl_current_language");n.data("$nl_localized_".concat(a)).val(this.value)}));var r=wp.oldEditor||wp.editor;if("object"===("undefined"==typeof tinymce?"undefined":n(tinymce))){tinymce.on("SetupEditor",(function(n){var a=n.editor||n,t=e(a.getElement()),l=t.data("$nl_localizer");l&&(a.on("init",(function(){e(a.getContainer()).parent().after(l)})),t.on("nl:localizer:update",(function(){var n=r.removep(a.getContent());t.val(n)})),t.on("nl:localizer:change",(function(){var n=r.autop(t.val());a.setContent(n)})))}));var o=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){o.apply(this,arguments),this.fire("SavedContent"),e(this.getElement()).trigger("nl:localizer:save")}}if(e(".nl-language-input").change((function(){var n=e(this).val(),a=e(this).parents(".nl-translation-manager");a.find(".nl-manage-translations").toggleClass("hidden","0"===n),a.find(".nl-translation-field").show(),a.find(".nl-translation-"+n).hide()})).change(),e(".nl-add-translation").click((function(){var n=e(this).parents(".nl-field"),t=n.find(".nl-input"),l=n.find(".nl-translation-select"),i=e("#post_ID").val(),r=e("#nl_language").val(),o=t.parents(".nl-field").data("nl_language");window.open(nlingualL10n.admin_post+"?"+e.param({action:"nl_new_translation",post_id:i,post_language_id:r,translation_language_id:o}),"_blank").onload=function(){var e=a(this.location.href.match(/post=(\d+)/),2)[1];t.val(e),n.addClass("nl-has-translation"),l.attr("name",null)}})),e(".nl-find-translation").click((function(){var n=e(this).parents(".nl-field"),a=n.find(".nl-translation-input"),t=n.find(".nl-translation-select");t.attr("name",a.attr("name")),t.show()})),e(".nl-edit-translation").click((function(){var n=e(this).parents(".nl-field").find(".nl-input").val();if("new"===n||parseInt(n,10)<=0)alert(nlingualL10n.NoPostSelected);else{var a=e(this).data("url").replace("%d",n);window.open(a)}})),e(".nl-drop-translation").click((function(){if(confirm(nlingualL10n.RemoveTranslationConfirm)){var n=e(this).parents(".nl-field"),a=n.find(".nl-translation-input"),t=n.find(".nl-translation-title"),l=e("#post_ID").val(),i=a.parents(".nl-field").data("nl_language");e.ajax({url:ajaxurl,type:"POST",data:{action:"nl_drop_translation",post_id:l,language_id:i},success:function(){a.val(null),t.text(nlingualL10n.NoTranslation),n.removeClass("nl-has-translation")},error:function(){alert(nlingualL10n.RemoveTranslationError)}})}})),"object"===("undefined"==typeof inlineEditPost?"undefined":n(inlineEditPost))){var c=inlineEditPost.edit;inlineEditPost.edit=function(n){c.apply(this,arguments);var a=n&&parseInt(this.getId(n),10)||0,t=e("#post-".concat(a)),l=e("#edit-".concat(a)),i=t.find(".nl-nonce").val();l.find(".nl-nonce").val(i);var r=t.find(".nl-language").val();l.find(".nl-language-input").val(r).change(),l.find(".nl-translation-field").each((function(){var n=e(this).data("nl_language"),a=t.find(".nl-translation-".concat(n)).val();e(this).find("select").val(a||0)}))}}}))}();
//# sourceMappingURL=admin.min.js.map