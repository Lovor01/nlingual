!function(){var n=window.nLingual={},e=n.Framework={},a=e.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),t=e.LanguageSet=Backbone.Collection.extend({model:a}),l=e.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),i=e.LocalizableFieldSet=Backbone.Collection.extend({model:l}),o=n.Languages=new t,r=n.LocalizableFields=new i;jQuery(function($){var e,t,l,i;if($(".nl-checkall").change(function(){var n=$(this).data("name");$('input[name="'+n+'[]"]').attr("checked",this.checked)}),$(".nl-matchall").change(function(){var n=$(this).data("name");$('[name="'+n+'"]').val(this.checked?"*":"")}),$(".nl-section-content").hide(),$(".nl-section-toggle").each(function(){$(this).data("text",$(this).text())}).click(function(){var n,e,a;n=$(this),e=n.parent(),e.toggleClass("open"),a=e.hasClass("open"),e.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(a?"alt":"text"))}),$(".nl-preview").on("nl:render",function(){var n,e,a,t,l,i;n=$("#nlingual_default_language").val(),n=o.get(n),n&&(e=n.get("slug")||"en"),a=$("#nlingual_query_var").val()||"nl_language",t=$("#nlingual_skip_default_l10n").attr("checked"),l=$("#nlingual_post_language_override").attr("checked"),i=$(this).hasClass("nl-url-preview")?$(this).data(t?"excluded":"included"):$(this).hasClass("nl-override-preview")?$(this).data(l?"on":"off"):$(this).data("format"),$(this).text(i.replace(/%l/g,e).replace(/%v/g,a))}).trigger("nl:render"),$("#nlingual_default_language").change(function(){$(".nl-preview").trigger("nl:render")}),$("#nlingual_skip_default_l10n").change(function(){$(".nl-preview").trigger("nl:render")}),$("#nlingual_post_language_override").change(function(){$(".nl-preview").trigger("nl:render")}),$("#nlingual_query_var").on("keyup change",function(){$(".nl-preview").trigger("nl:render")}),$(".nl-preview").hide().filter(".nl-redirect-get").show(),$('input[name="nlingual_options[url_rewrite_method]"]').change(function(){var n=$(this).val();this.checked&&n&&$(".nl-preview").hide().filter(".nl-redirect-"+n).show()}).change(),$("#nlingual_languages").each(function(){function e(n){var e,a,t,l;e=s,e=e.replace(/%id%/g,n.id);for(l in n.attributes)t=new RegExp("%"+l+"%","g"),e=e.replace(t,n.get(l));a=$(e),a.find('.nl-language-direction input[value="'+n.get("direction")+'"]').attr("checked",!0),a.find(".nl-language-active input").attr("checked",n.get("active")),i.append(a).sortable("refresh")}var t,l,i,r,s,d,c;t=$(this),l=$("#nl_language_preset"),i=$("#nl_language_list"),r=$("#nl_language_add"),s=$("#nl_language_row").text(),d=-1,i.sortable({items:"tr",containment:"parent",handle:".handle"});for(c in n.presets)l.append('<option value="'+c+'">'+n.presets[c].system_name+"</option>");o.each(e),r.click(function(){var t,i;l.val()?(i=l.val(),t=new a(n.presets[i]),t.set("iso_code",i),l.val(null)):t=new a,t.id=d,t.set("slug",t.get("iso_code")),t.set("active",!0),e(t),d--}),t.on("change",".nl-language-delete input",function(){var n=$(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)}),t.on("change",".nl-language-system_name input",function(){var n,e,a,t,l;n=$(this).parents("tr").first(),e=$(this).val(),a=n.find(".nl-language-locale_name input"),t=n.find(".nl-language-iso_code input"),l=n.find(".nl-language-slug input"),t.val()||t.val(e.substr(0,2).toLowerCase()),a.val()||a.val(t.val()),l.val()||l.val(t.val())})}),e=$('<span class="nl-localizer"></span>').html(function(){var n='<span class="nl-localizer-toggle" title="'+nlingualL10n.LocalizeThis+'"></span>';return o.each(function(e){n+='<span class="nl-localizer-option" title="'+nlingualL10n.LocalizeFor.replace("%s",e.get("system_name"))+'" data-nl_language="'+e.id+'"><i class="nl-option-text" data-slug="'+e.get("slug")+'">'+e.get("system_name")+"</i></span>"}),n}),t="nlLocalizerSkipUpdate",r.each(function(a){var t,l,i,r,s,d,c,g;t=a.get("field_id"),l=a.get("values"),i=a.get("nonce"),r=!1,s=$("#"+t),0!==s.length&&s.is("input, textarea")&&(s.addClass("nl-localizable-input"),s.hasClass("wp-editor-area")?d=s.parents(".wp-editor-wrap"):(s.wrap('<span class="nl-localizable"></span>'),d=s.parent()),c=e.clone(),s.data("$nl_localizer",c),c.data("nl_current_language",n.default_language),c.data("$nl_localizer_field",s),g=$('<input type="hidden" />'),g.attr("name",s.attr("name")),g.val(s.val()),g.appendTo(d),c.data("$nl_localized_"+n.default_language,g),o.each(function(e){var a,t;n.default_language!==e.id&&(a=l[e.id]||null,t=$('<input type="hidden" />'),t.attr("name","nlingual_localized["+s.attr("name")+"]["+e.id+"]"),t.val(a),c.data("$nl_localized_"+e.id,t),t.appendTo(d),""!==a&&null!==a&&(r=!0))}),r&&c.find('[data-nl_language="'+n.default_language+'"]').addClass("nl-current"),d.append('<input type="hidden" name="_nl_l10n_nonce['+a.id+']" value="'+i+'" />'),c.appendTo(d))}),$("body").on("click",".nl-localizer-option",function(){var e,a,t,l,i,o,r;e=$(this),a=e.parent(),i=e.data("nl_language"),$(this).addClass("nl-current").siblings().removeClass("nl-current"),i||(i=n.default_language),t=a.data("$nl_localizer_field"),l=a.data("$nl_localized_"+i),t.trigger("nl:localizer:update"),a.data("nl_current_language",i),o=l.val(),r=l.attr("name"),t.val(o).attr("name",r),t.trigger("nl:localizer:change")}),$("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",function(){var n,e,a;n=$(this).data("$nl_localizer"),a=n.data("nl_current_language"),e=n.data("$nl_localized_"+a),e.val(this.value)}),"object"==typeof tinymce){tinymce.on("SetupEditor",function(n){var e=n.editor||n,a=$(e.getElement()),t=a.data("$nl_localizer");t&&(e.on("init",function(){$(e.getContainer()).parent().after(t)}),a.on("nl:localizer:update",function(){var n=e.getContent();n=wp.editor.removep(n),a.val(n)}),a.on("nl:localizer:change",function(){var n=a.val();n=wp.editor.autop(n),e.setContent(n)}))});var s=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){s.apply(this,arguments),this.fire("SavedContent"),$(this.getElement()).trigger("nl:localizer:save")}}var d=$("#nl_translation_finder");$(".nl-language-input").change(function(){var n,e;n=$(this).val(),e=$(this).parents(".nl-translations-manager"),e.find(".nl-set-translations").toggleClass("hidden","0"===n),e.find(".nl-translation-field").show(),e.find(".nl-translation-"+n).hide()}).change(),$(".nl-find-translation").click(function(){function n(n){return function(){var t=nlingualL10n.UseFoundTranslation.replace("%1$s",n.title).replace("%2$s",o.get(i).get("system_name"));confirm(t)&&(e.addClass("nl-is-set"),a.val(n.id),d.hide())}}var e,a,t,l,i,r;e=$(this).parents(".nl-field"),a=e.find(".nl-input"),t=parseInt(a.val(),10),l=$("#post_type").val(),i=a.parents(".nl-field").data("nl_language"),r=d.find("ul"),d.show(),r.empty(),$.ajax({url:ajaxurl,data:{action:"nl_find_translations",post_type:l,language_id:i},dataType:"json",success:function(e){console.log(e);var a,l,i;for(a=0;a<e.length;a++)l=e[a],i=$('<li class="nl-translation-item"></li>').text(l.title),i.toggleClass("current",l.id===t),i.on("click",n(l)),r.append(i)},error:function(n){alert(n.responseText||nlingualL10n.FindTranslationsError)}})}),$(".nl-add-translation").click(function(){var n,e,a,t,l;n=$(this).parents(".nl-field"),e=n.find(".nl-input"),a=$("#post_ID").val(),t=$("#nl_language").val(),l=e.parents(".nl-field").data("nl_language"),window.open("/wp-admin/admin-post.php?"+$.param({action:"nl_new_translation",post_id:a,post_language_id:t,translation_language_id:l}),"_blank").onload=function(){var a=this.location.href.match(/post=(\d+)/),t=a[1];e.val(t),n.addClass("nl-is-set")}}),$(".nl-edit-translation").click(function(){var n,e,a;if(n=$(this).parents(".nl-field"),"new"===(e=n.find(".nl-input").val())||parseInt(e)<=0)return void alert(nlingualL10n.NoPostSelected);a=$(this).data("url").replace("%d",e),window.open(a)}),"object"==typeof inlineEditPost&&(l=inlineEditPost.edit,inlineEditPost.edit=function(n){var e,a,t,i,o;l.apply(this,arguments),e=0,"object"==typeof n&&(e=parseInt(this.getId(n))),a=$("#post-"+e),t=$("#edit-"+e),i=a.find(".nl-nonce").val(),t.find(".nl-nonce").val(i),o=a.find(".nl-language").val(),t.find(".nl-language-input").val(o).change(),t.find(".nl-translation-field").each(function(){var n,e;n=$(this).data("nl_language"),e=a.find(".nl-translation-"+n).val(),$(this).find("select").val(e||0)})}),"object"==typeof inlineEditTax&&(i=inlineEditTax.edit,inlineEditTax.edit=function(){i.apply(this,arguments)})})}();
//# sourceMappingURL=./admin.min.js.map