!function(){var g=window.nLingual={},n=g.Framework={},o=n.Language=Backbone.Model.extend({defaults:{system_name:"",native_name:"",short_name:"",iso_code:"",slug:"",locale_name:"",direction:"",active:!0}}),a=n.LanguageSet=Backbone.Collection.extend({model:o}),e=n.LocalizableField=Backbone.Model.extend({idAttribute:"field",defaults:{field_id:"",values:"",nonce:""}}),t=n.LocalizableFieldSet=Backbone.Collection.extend({model:e}),u=g.Languages=new a,i=g.LocalizableFields=new t;jQuery(function(s){var c,n,d,a;if(s(".nl-checkall").change(function(){var n=s(this).data("name");s('input[name="'+n+'[]"]').attr("checked",this.checked)}),s(".nl-matchall").change(function(){var n=s(this).data("name");s('[name="'+n+'"]').val(this.checked?"*":"")}),s(".nl-section-content").hide(),s(".nl-section-toggle").each(function(){s(this).data("text",s(this).text())}).click(function(){var n,a,e;(a=(n=s(this)).parent()).toggleClass("open"),e=a.hasClass("open"),a.find(".nl-section-content").animate({height:"toggle"}),n.text(n.data(e?"alt":"text"))}),s(".nl-preview").on("nl:render",function(){var n,a,e,t,l,i;n=s("#nlingual_default_language").val(),(n=u.get(n))&&(a=n.get("slug")||"en"),e=s("#nlingual_query_var").val()||"nl_language",t=s("#nlingual_skip_default_l10n").attr("checked"),l=s("#nlingual_post_language_override").attr("checked"),i=s(this).hasClass("nl-url-preview")?s(this).data(t?"excluded":"included"):s(this).hasClass("nl-override-preview")?s(this).data(l?"on":"off"):s(this).data("format"),s(this).text(i.replace(/%l/g,a).replace(/%v/g,e))}).trigger("nl:render"),s("#nlingual_default_language").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_skip_default_l10n").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_post_language_override").change(function(){s(".nl-preview").trigger("nl:render")}),s("#nlingual_query_var").on("keyup change",function(){s(".nl-preview").trigger("nl:render")}),s(".nl-preview").hide().filter(".nl-redirect-get").show(),s('input[name="nlingual_options[url_rewrite_method]"]').change(function(){var n=s(this).val();this.checked&&n&&s(".nl-preview").hide().filter(".nl-redirect-"+n).show()}).change(),s("#nlingual_languages").each(function(){var n,e,i,a,d,t,l;for(l in n=s(this),e=s("#nl_language_preset"),i=s("#nl_language_list"),a=s("#nl_language_add"),d=s("#nl_language_row").text(),t=-1,i.sortable({items:"tr",containment:"parent",handle:".handle"}),g.presets)e.append('<option value="'+l+'">'+g.presets[l].system_name+"</option>");function r(n){var a,e,t,l;for(l in a=(a=d).replace(/%id%/g,n.id),n.attributes)t=new RegExp("%"+l+"%","g"),a=a.replace(t,n.get(l));(e=s(a)).find('.nl-language-direction input[value="'+n.get("direction")+'"]').attr("checked",!0),e.find(".nl-language-active input").attr("checked",n.get("active")),i.append(e).sortable("refresh")}u.each(r),a.click(function(){var n,a;e.val()?(a=e.val(),(n=new o(g.presets[a])).set("iso_code",a),e.val(null)):n=new o,n.id=t,n.set("slug",n.get("iso_code")),n.set("active",!0),r(n),t--}),n.on("change",".nl-language-delete input",function(){var n=s(this).parents("tr").first();n.toggleClass("todelete",this.checked),n.find("input").not(this).attr("disabled",this.checked)}),n.on("change",".nl-language-system_name input",function(){var n,a,e,t,l;n=s(this).parents("tr").first(),a=s(this).val(),e=n.find(".nl-language-locale_name input"),t=n.find(".nl-language-iso_code input"),l=n.find(".nl-language-slug input"),t.val()||t.val(a.substr(0,2).toLowerCase()),e.val()||e.val(t.val()),l.val()||l.val(t.val())})}),c=s('<div class="nl-localizer"></div>').html(function(){var a='<div class="nl-localizer-toggle" title="'+nlingualL10n.LocalizeThis+'"></div>';return u.each(function(n){a+='<div class="nl-localizer-option" title="'+nlingualL10n.LocalizeFor.replace("%s",n.get("system_name"))+'" data-nl_language="'+n.id+'"><div class="nl-option-text" data-slug="'+n.get("slug")+'">'+n.get("system_name")+"</div></div>"}),a}),n="nlLocalizerSkipUpdate",i.each(function(n){var a,t,e,l,i,d,r,o;a=n.get("field_id"),t=n.get("values"),e=n.get("nonce"),l=!1,0!==(i=s("#"+a)).length&&i.is("input, textarea")&&(i.addClass("nl-localizable-input"),d=i.hasClass("wp-editor-area")?i.parents(".wp-editor-wrap"):(i.wrap('<div class="nl-localizable"></div>'),i.parent()),r=c.clone(),i.data("$nl_localizer",r),r.data("nl_current_language",g.default_language),r.data("$nl_localizer_field",i),(o=s('<input type="hidden" />')).attr("name",i.attr("name")),o.val(i.val()),o.appendTo(d),r.data("$nl_localized_"+g.default_language,o),u.each(function(n){var a,e;g.default_language!==n.id&&(a=t[n.id]||null,(e=s('<input type="hidden" />')).attr("name","nlingual_localized["+i.attr("name")+"]["+n.id+"]"),e.val(a),r.data("$nl_localized_"+n.id,e),e.appendTo(d),""!==a&&null!==a&&(l=!0))}),l&&r.find('[data-nl_language="'+g.default_language+'"]').addClass("nl-current"),d.append('<input type="hidden" name="_nl_l10n_nonce['+n.id+']" value="'+e+'" />'),r.appendTo(d))}),s("body").on("click",".nl-localizer-option",function(){var n,a,e,t,l,i,d;a=(n=s(this)).parent(),l=n.data("nl_language"),s(this).addClass("nl-current").siblings().removeClass("nl-current"),l||(l=g.default_language),e=a.data("$nl_localizer_field"),t=a.data("$nl_localized_"+l),e.trigger("nl:localizer:update"),a.data("nl_current_language",l),i=t.val(),d=t.attr("name"),e.val(i).attr("name",d),e.trigger("nl:localizer:change")}),s("body").on("input nl:localizer:update nl:localizer:save",".nl-localizable-input",function(){var n,a,e;e=(n=s(this).data("$nl_localizer")).data("nl_current_language"),(a=n.data("$nl_localized_"+e)).val(this.value)}),"object"==typeof tinymce){tinymce.on("SetupEditor",function(n){var a=n.editor||n,e=s(a.getElement()),t=e.data("$nl_localizer");t&&(a.on("init",function(){s(a.getContainer()).parent().after(t)}),e.on("nl:localizer:update",function(){var n=a.getContent();n=wp.editor.removep(n),e.val(n)}),e.on("nl:localizer:change",function(){var n=e.val();n=wp.editor.autop(n),a.setContent(n)}))});var e=tinymce.Editor.prototype.save;tinymce.Editor.prototype.save=function(){e.apply(this,arguments),this.fire("SavedContent"),s(this.getElement()).trigger("nl:localizer:save")}}if(wp&&wp.media&&wp.media.view){var l=wp.media.view.Attachment.Details.prototype.render;wp.media.view.Attachment.Details.prototype.render=function(){var n,d,a,e,r,t;return n=l.apply(this,arguments),(d=this.model.get("localized_values"))&&(a=s('<label class="setting nl-localizer-languages"></label>').html(function(){var e='<span class="name">Translate</span>';return e+='<span class="value">',u.each(function(n,a){0<a&&(e+=" | "),e+='<a href="#" class="nl-localizer-language" data-nl_language="'+n.id+'">'+n.get("system_name")+"</a>"}),e+="</span>"}),e=a.find(".nl-localizer-language"),this.$(".settings").prepend(a),r=this,_.each(["title","caption","alt","description"],function(t){var l,i;(l=i=r.$('.setting[data-setting="'+t+'"]')).addClass("nl-localizer-field"),u.each(function(n){var a,e;if(n.id===g.default_language)return!0;a="localized_"+n.id+"_"+t,(e=l.clone()).addClass("nl-language-"+n.id),e.data("setting",a).attr("data-setting",a),e.find("input,textarea").val(d[t][n.id]),i.after(e),i=e}),l.addClass("nl-language-"+g.default_language)}),t=this.$(".nl-localizer-field"),e.on("click",function(){var n;e.removeClass("nl-current"),s(this).addClass("nl-current"),n=s(this).data("nl_language"),t.hide().filter(".nl-language-"+n).show()}),e.filter('[data-nl_language="'+g.default_language+'"]').trigger("click")),n}}s(".nl-language-input").change(function(){var n,a;n=s(this).val(),(a=s(this).parents(".nl-translation-manager")).find(".nl-manage-translations").toggleClass("hidden","0"===n),a.find(".nl-translation-field").show(),a.find(".nl-translation-"+n).hide()}).change(),s(".nl-translation-field").each(function(){var n=s(this).find(".nl-input").val(),a=s(this).find(".nl-add-translation"),e=s(this).find(".nl-edit-translation");e.hide(),parseInt(n)&&(a.hide(),e.show())}),s(".nl-add-translation").click(function(){var n,e,t,l,a,i,d,r;n=s(this).parents(".nl-field"),e=n.find(".nl-input"),t=n.find(".nl-add-translation"),l=n.find(".nl-edit-translation"),a=s("#post_ID").val(),i=s("#nl_language").val(),d=e.parents(".nl-field").data("nl_language"),window.open("/wp-admin/admin-post.php?"+s.param({action:"nl_new_translation",post_id:a,post_language_id:i,translation_language_id:d}),"_blank").onload=function(){var n,a=this.location.href.match(/post=(\d+)/)[1];e.val(a),t.hide(),l.show().attr("title")}}),s(".nl-edit-translation").click(function(){var n,a,e;"new"===(a=(n=s(this).parents(".nl-field")).find(".nl-input").val())||parseInt(a)<=0?alert(nlingualL10n.NoPostSelected):(e=s(this).data("url").replace("%d",a),window.open(e))}),"object"==typeof inlineEditPost&&(d=inlineEditPost.edit,inlineEditPost.edit=function(n){var a,e,t,l,i;d.apply(this,arguments),a=0,"object"==typeof n&&(a=parseInt(this.getId(n))),e=s("#post-"+a),t=s("#edit-"+a),l=e.find(".nl-nonce").val(),t.find(".nl-nonce").val(l),i=e.find(".nl-language").val(),t.find(".nl-language-input").val(i).change(),t.find(".nl-translation-field").each(function(){var n,a;n=s(this).data("nl_language"),a=e.find(".nl-translation-"+n).val(),s(this).find("select").val(a||0)})}),"object"==typeof inlineEditTax&&(a=inlineEditTax.edit,inlineEditTax.edit=function(){a.apply(this,arguments)})})}();
//# sourceMappingURL=admin.min.js.map